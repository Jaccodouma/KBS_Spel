#pragma once
#include "gameobject.h"
#include "player.h"

#define EXPLOSION_RANGE 3
#define FIRE_TIME 1000 // 1 seconde

// state:

#define EX_MIDDLE 0
#define EX_HORIZONTAL 1
#define EX_VERTICAL 2
#define EX_LEFT 3
#define EX_RIGHT 4
#define EX_TOP 5
#define EX_BOT 6


class Explosion : public Gameobject {
   public:
    Player *player;
    Explosion(uint8_t x, uint8_t y, Player *p, uint8_t bitmaptype = EX_MIDDLE);
    void update(int prevUpdate);
    void draw(Gfx *gfx);
    void onDelete(Gfx *gfx);
    void onPlayerCollision(Player *p);
    const bitmap16_t *getBitmap();

    private:
        int countdown = FIRE_TIME;
};

const uint8_t explosion_middle[][32] PROGMEM = {
    { 
   0x10, 0x08, 0x10, 0x08, 0x18, 0x18, 0x0c, 0x30, 0x07, 0xe0, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xe0,
   0x0c, 0x30, 0x18, 0x18, 0x10, 0x08, 0x10, 0x08 }, //rood
{
   0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x10, 0x08, 0x08, 0x10, 0x07, 0xe0,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xe0, 0x08, 0x10,
   0x10, 0x08, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04 }, //donkeroranje
   {
   0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x60, 0x06, 0x30, 0x0c, 0x18, 0x18,
   0x0f, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x0f, 0xf0, 0x18, 0x18, 0x30, 0x0c,
   0x60, 0x06, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02 }, //lichtoranje
   {
   0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0xc0, 0x03, 0xe0, 0x07,
   0xf0, 0x0f, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x0f, 0xe0, 0x07, 0xc0, 0x03,
   0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01 } //geel
};


const uint8_t explosion_horizontal_line[][32] PROGMEM = {
   {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }, //rood
   {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }, //donkeroranje
   {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },  //lichtoranje
   {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 } //geel
};

const uint8_t explosion_vertical_line[][32] PROGMEM = {
   {
   0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08,
   0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08,
   0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08 }, //rood
   {
   0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04,
   0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04,
   0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04 }, //donkeroranje
   {
   0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02,
   0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02,
   0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02 }, //lichtoranje
   {
   0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01,
   0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01,
   0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01 } //geel
};

const uint8_t explosion_corner_top[][32] PROGMEM = {
   {
   0x80, 0x01, 0x40, 0x02, 0x20, 0x04, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08,
   0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08,
   0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08 }, //rood
   {
   0x00, 0x00, 0x80, 0x01, 0x40, 0x02, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04,
   0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04,
   0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04 }, //donkeroranje
   {
   0x00, 0x00, 0x00, 0x00, 0x80, 0x01, 0xc0, 0x03, 0x40, 0x02, 0x40, 0x02,
   0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02,
   0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02 }, //lichtoranje
   {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x01, 0x80, 0x01,
   0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01,
   0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01 } //geel
};

const uint8_t explosion_corner_bottom[][32] PROGMEM = {
   { 
   0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08,
   0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08, 0x10, 0x08,
   0x10, 0x08, 0x20, 0x04, 0x40, 0x02, 0x80, 0x01 }, //rood
   {
   0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04,
   0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04, 0x20, 0x04,
   0x20, 0x04, 0x40, 0x02, 0x80, 0x01, 0x00, 0x00 }, //donkeroranje
   {
   0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02,
   0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02,
   0xc0, 0x03, 0x80, 0x01, 0x00, 0x00, 0x00, 0x00 }, //lichtoranje
   {
   0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01,
   0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01, 0x80, 0x01,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 } //geel
};


const uint8_t explosion_corner_right[][32] PROGMEM = {
{
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x1f, 0x00, 0x20,
   0x00, 0x40, 0x00, 0x80, 0x00, 0x80, 0x00, 0x40, 0x00, 0x20, 0xff, 0x1f,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }, //rood
   {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x1f,
   0x00, 0x20, 0x00, 0x40, 0x00, 0x40, 0x00, 0x20, 0xff, 0x1f, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }, //donkeroranje
   {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0xff, 0x1f, 0x00, 0x30, 0x00, 0x30, 0xff, 0x1f, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }, //lichtoranje
   {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0xff, 0x0f, 0xff, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 } //geel
};

const uint8_t explosion_corner_left[][32] PROGMEM = {
{
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0xff, 0x04, 0x00,
   0x02, 0x00, 0x01, 0x00, 0x01, 0x00, 0x02, 0x00, 0x04, 0x00, 0xf8, 0xff,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }, //rood
   {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0xff,
   0x04, 0x00, 0x02, 0x00, 0x02, 0x00, 0x04, 0x00, 0xf8, 0xff, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }, //donkeroranje
   {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0xf8, 0xff, 0x0c, 0x00, 0x0c, 0x00, 0xf8, 0xff, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }, //lichtoranje
   {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0xf0, 0xff, 0xf0, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 } //geel
};
